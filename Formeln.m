%% Hochauftrieb II (Kurvensynthetisierung)

%% Input
dzul         = 0.13   %Dickenverhältniss des Profils [-]
delta_k      = 30     %maximaler Klappenwinkel (Fowlerklappe)[°] 
ck_c         = 0.3    %Tiefenverhältnis Klappe zu Profiltiefe [-] 
SVzuS        = 0.85   %Verhältnis Slat-Spannweite einer Flügelseite zu halbe Flügelspannweite [-]
etaVzuetaOpt = 0.85   %Verhältnis Slat-Winkel zu Slat-Winkel optimal [-]
lVzul        = 0.12   %Verhältnis von Slat-Tiefe zu Profiltiefe [-]
phi_V        = 30.2   %Pfeilungswinkel der Vorderkanntenklappen (Scharnierline) [°]
lambda       = 0.26   %Zuspitzung des Flügels [-]
bf_s         = 0.7    %prozentuale Spannweite der Hinterkantenklappen

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Hinterkantenhochauftriebshifen (Fowlerklappe) %% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Änderung des maximalen Auftriebsbeiwertes bei Fowlerklappen (Abbildung 4)
% Scalefaktoren für jeweiligen Polynomkoeffizienten aus Abbildung 4 (nicht verändern!!!)
scale = [4.8000e-11 7.4440e-09 4.334640000000000e-07 1.183311400000000e-05...
            1.521585600000000e-04 7.375495839999982e-04 0.019789769923000]*(12-dzul*100);
% Polynom 6.Grades für Delta cA_max_0.3 -> abgeleitet aus Abbildung 4
Delta_cA_max_03 = (-0.000000000244 + scale(1,1)) * delta_k^6 +...
                    (0.000000025478 - scale(1,2)) * delta_k^5 +...
                     (-0.000000947076 + scale(1,3)) * delta_k^4 +...
                      (0.000013800129 - scale(1,4)) * delta_k^3 +...
                       (-0.00034001589 + scale(1,5)) * delta_k^2 +...
                        (0.040075520038 - scale(1,6)) * delta_k^1 +...
                         (0.34273024258 - scale(1,7));

% ck/c Korrektur für Verhältnisse ungleich 0.3 (K2 nach Abbildung 5 rechts unten)
% Funktionen für K2_20 und K2_45 sowie K2 bei ck_c >= 0.25 sind aus Diagramm abgeleitet 
if ck_c >= 0.25
  K2 = 1.2 * ck_c + 0.64;
else
  K2_20 = -8.0000 * ck_c^2 + 5.4000 * ck_c + 0.0900;
  K2_45 = -7.0000 * ck_c^2 + 6.0700 * ck_c - 0.1385; 
  K2 = (K2_45 - K2_20) / (45 - 20) * (delta_k - 20) + K2_20;
end

%% Änderung des Auftriebsbeiwertes bei ausgefahrenen Fowlerklappen (Abbildung 5)
% (Auftriebsbeiwertzuwachs bei alpha0+6)
% Scalefaktoren für 20° und 45° Polynom
Scale_20 = [-21.659819796216000 -26.467151512915002 11.590245567996000 ...
                -2.111728319442000 0.155971610411000]*(12-dzul*100);            
Scale_45 = [-29.100038781762002 -36.807566854566005 -17.023588217222002 ...
                -3.417869868661001 0.276834572918000]*(12-dzul*100);

% Polynome für 20° und 45° aus Abbildung 5 abgeleitet
delta_cA_20 = (-33.973775997758 + Scale_20(1,1)) * ck_c^4 +...
                 (27.143038045956 - Scale_20(1,2)) * ck_c^3 +...
                    (-10.797984204775 - Scale_20(1,3)) * ck_c^2 +...
                        (5.074652202923 - Scale_20(1,4)) * ck_c^1 +...
                            (0.07610812643 - Scale_20(1,5));

delta_cA_45 = (-82.815762549639 + Scale_45(1,1)) * ck_c^4 +...
                 (86.158234798928 - Scale_45(1,2)) * ck_c^3 +...
                    (-39.786836056421 + Scale_45(1,3)) * ck_c^2 +...
                        (12.717255336628 - Scale_45(1,4)) * ck_c^1 +...
                            (-0.265461748617 - Scale_45(1,5));
% Interpolation
delta_cA_K_Phi0 = (delta_cA_45 - delta_cA_20) / (45 - 20) * (delta_k - 20) + delta_cA_20;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Vorderkantenhochauftriebshilfen %% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  Änderung des max. Auftriebsbeiwertes durch Vorflügel (Abbildung 7)
% Spannweiteneifluss - Polynom aus Abbildung 7 links abgeleitet
f_SV = 11.765565102687 * SVzuS^6 - 32.463064895943 * SVzuS^5 + 30.263612011448 * SVzuS^4 -...
            10.126813470386 * SVzuS^3 + 1.328658466635 * SVzuS^2 + 0.232672394952  * SVzuS -...
                0.000177240537;
            
% Winkeleinfluss - Polynom aus Abbildung 7 mitte abgeleitet
f_etaV = -0.012101754267 * etaVzuetaOpt^3 - 0.896711153753 * etaVzuetaOpt^2 +...
            1.904046567033 * etaVzuetaOpt + 0.003534484637;

% Tiefeneinfluss - Geradengleichung aus Abbildung 7 rechts abgeleitet (y=mx+n, mit n=0)
f_lV = 6.607542800733 * lVzul;

% Pfeilungseinfluss - Gleichung nach Abbildung 7 (f_phi_V=cos^3(phi_V-5°))
f_phi_V = cosd(phi_V-5)^3;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Momentenänderung bei High-Lift-Konfiguration %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%nach Skript Teil D Seite 114
LS_Polare.dcMk_dcmK  = ( 3.739701 * lambda^4 - 10.762986 * lambda^3 + 12.791164 * lambda^2 - 8.860305 * lambda + 4.093244) * bf_s + ...
                            (-5.744622 * lambda^4 + 17.487598 * lambda^3 - 21.515763 * lambda^2 + 13.990786 * lambda - 4.219788) * bf_s^2 +...
                                ( 1.960553 * lambda^4 -  7.330970 * lambda^3 + 10.252347 * lambda^2 -  6.347223 * lambda + 1.466302) * bf_s^3;

%nach Skript Teil D Seite 114
LS_Polare.dcMk_dcAK =  (-0.254693 * lambda^3 + 0.343337 * lambda^2 - 0.172780 * lambda + 0.333119) * bf_s +...
                            ( 0.986155 * lambda^3 - 1.620515 * lambda^2 + 1.049655 * lambda - 0.661691) * bf_s^2 + ...
                                (-0.735627 * lambda^3 + 1.282365 * lambda^2 - 0.877425 * lambda + 0.328347) * bf_s^3;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Widerstandszuwachs durch Hochauftriebshilfen %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Änderung des Profilwiderstandes der Fowlerklappe nach Abbildung 8 Übungsumdruck
if ck_c >= 0.1 && ck_c < 0.2
    scale = [5.249999999999999e-10; 8.7776e-08; 4.962882e-06;...
                1.37873927e-04; 0.001498773799; 0.006381460367] * (0.1*10 - ck_c*10);
    delta_cWp = (-0.000000000317+scale(1,1)) * delta_k^5 +...
                    (0.000000037162-scale(2,1)) * delta_k^4 +...
                        (-0.000001274231+scale(3,1)) * delta_k^3 +...
                            (0.000026857482-scale(4,1)) * delta_k^2 +...
                                (-0.000202263833+scale(5,1)) * delta_k^1 +...
                                    (0.002280913801-scale(6,1)) * delta_k^0;   
                                
elseif ck_c >= 0.2 && ck_c <= 0.3
    scale = [7.24e-10; 1.30444e-07; 7.757163999999999e-06;...
                1.82737764e-04; 0.002290710059; 0.009372114943] * (0.2*10 - ck_c*10);
    delta_cWp = (-0.000000000842-scale(1,1)) * delta_k^5 +...
                    (0.000000124938+scale(2,1)) * delta_k^4 +...
                        (-0.000006237113-scale(3,1)) * delta_k^3 +...
                            (0.000164731409+scale(4,1)) * delta_k^2 +...
                                (-0.001701037632-scale(5,1)) * delta_k^1 +...
                                    (0.008662374168+scale(6,1)) * delta_k^0;

elseif ck_c > 0.3
    scale = [2.2e-09; 2.20983e-07; 5.5353670e-06;...
                4.1827823e-05; 0.001403719002; 0.009397427876] * (0.3*10 - ck_c*10);
    delta_cWp = (-0.000000000118-scale(1,1)) * delta_k^5 +...
                    (-0.000000005506+scale(2,1)) * delta_k^4 +...
                        (0.000001520051-scale(3,1)) * delta_k^3 +...
                            (-0.000018006355-scale(4,1)) * delta_k^2 +...
                                (0.000589672427+scale(5,1)) * delta_k^1 +...
                                    (-0.000709740775-scale(6,1)) * delta_k^0;
end